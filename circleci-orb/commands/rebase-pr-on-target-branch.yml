description: Rebase PR on the target branch

parameters:
  head_revision:
    type: string
    description: The `pipeline.git.revision` pipeline value.
  base_revision:
    type: string
    description: The `pipeline.git.base_revision` pipeline value.
  primary_branch_name:
    type: string
    description: The primary branch for the repository.
    default: 'main'

steps:
  - run:
      environment:
        MAIN_BRANCH_NAME: << parameters.primary_branch_name >>
        CIRCLE_GIT_BASE_REVISION: << parameters.base_revision >>
        CIRCLE_GIT_HEAD_REVISION: << parameters.head_revision >>
      name: Rebasing PR on the target branch
      command: << include(../dist/bin/circleci-orb/scripts/rebase-pr-on-target-branch/script.sh) >>
